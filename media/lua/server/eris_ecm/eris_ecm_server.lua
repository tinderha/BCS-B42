----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
--
-- eris_ecm_server
--
--
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------

if isClient() then return; end;

----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------

local eris_ecm_server = {};

----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------

eris_ecm_server.pong = function(_packet)
	local now = getTimestampMs();
	_packet.cts = now - _packet.client_now;
	_packet.server_now = now;
	sendServerCommand("eris_ecm_client", "pong", _packet);
end

----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------

eris_ecm_server.onClientCommand = function(_module, _command, _plObj, _packet)
	if _module ~= "eris_ecm_server" then return; end;
	if _command == "ping" then
		if _packet then
			eris_ecm_server.pong(_packet);
		end;
	end;
end

----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------

Events.OnClientCommand.Add(eris_ecm_server.onClientCommand);

----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------